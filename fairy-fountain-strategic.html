<!DOCTYPE html>
<html>
<head>
    <title>Fairy Fountain Alarm (Strategic Design)</title>
    <style>
        body {
            font-family: monospace;
            max-width: 700px;
            margin: 50px auto;
            background: #1a1a1a;
            color: #0f0;
            padding: 20px;
        }
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 20px 40px;
            font-size: 20px;
            font-family: monospace;
            cursor: pointer;
            margin: 15px 5px;
        }
        button:hover { background: #0d0; }
        button:active { background: #090; }
        .status {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #0f0;
            min-height: 60px;
        }
        h1 { color: #0f0; }
        .pattern {
            background: #222;
            padding: 15px;
            margin: 15px 0;
            border-left: 3px solid #0f0;
            line-height: 1.8;
        }
    </style>
</head>
<body>
    <h1>⏰ Fairy Fountain Alarm - Strategic Planning Design</h1>
    
    <div class="pattern">
        <strong>Design by @strategic-planning-architect</strong><br><br>
        
        <strong>Phase 1 (Dreamy):</strong> B4→E5→A5→B5 harp cascade, slow and warm (400ms notes)<br>
        <strong>Phase 2 (Building):</strong> Same pattern, faster (240ms notes), getting insistent<br>
        <strong>Phase 3 (Urgent):</strong> B5→E6→A6→B6, rapid + octave jump (120ms notes), wake up!<br><br>
        
        <strong>Key insight:</strong> Lower octave (B4) sounds like actual harp, not beeps.<br>
        Tiny rests (40-80ms) keep it flowing, not disconnected.
    </div>

    <button onclick="playFairyFountain()">▶ Play Fairy Fountain Alarm</button>
    <button onclick="stopAll()">⏹ Stop</button>

    <div class="status" id="status">Ready. Square wave synthesis matches watch buzzer.</div>

    <script>
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let scheduledNotes = [];

        const notes = {
            B4: 493.88,
            E5: 659.25,
            A5: 880.00,
            B5: 987.77,
            E6: 1318.51,
            A6: 1760.00,
            B6: 1975.53
        };

        function playTone(frequency, duration, startTime, volume = 0.5) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = 'square'; // Match watch buzzer
            
            gainNode.gain.setValueAtTime(0, startTime);
            gainNode.gain.linearRampToValueAtTime(volume, startTime + 0.005);
            gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            
            oscillator.start(startTime);
            oscillator.stop(startTime + duration);
            
            scheduledNotes.push(oscillator);
        }

        function playFairyFountain() {
            stopAll();
            document.getElementById('status').textContent = 'Playing: Fairy Fountain Alarm (repeating 3 times)';
            
            let time = audioContext.currentTime + 0.1;
            const unit = 0.04; // 40ms per unit
            
            // Repeat the entire alarm sequence 3 times
            for (let repeat = 0; repeat < 3; repeat++) {
                // Phase 1: Dreamy harp (B4-E5-A5-B5) — warm lower octave
                // Play twice: 10 units notes, 2 units rest
                for (let cycle = 0; cycle < 2; cycle++) {
                    playTone(notes.B4, 10*unit, time, 0.5); time += 10*unit;
                    time += 2*unit;
                    playTone(notes.E5, 10*unit, time, 0.5); time += 10*unit;
                    time += 2*unit;
                    playTone(notes.A5, 10*unit, time, 0.5); time += 10*unit;
                    time += 2*unit;
                    playTone(notes.B5, 10*unit, time, 0.55); time += 10*unit;
                    time += 2*unit;
                }
                
                // Phase 2: Building (same notes) — faster tempo
                // Play twice: 6 units notes, 1 unit rest
                for (let cycle = 0; cycle < 2; cycle++) {
                    playTone(notes.B4, 6*unit, time, 0.6); time += 6*unit;
                    time += 1*unit;
                    playTone(notes.E5, 6*unit, time, 0.6); time += 6*unit;
                    time += 1*unit;
                    playTone(notes.A5, 6*unit, time, 0.6); time += 6*unit;
                    time += 1*unit;
                    playTone(notes.B5, 6*unit, time, 0.65); time += 6*unit;
                    time += 1*unit;
                }
                
                // Phase 3: Urgent (B5-E6-A6-B6) — octave jump, rapid
                // Play twice: 3 units notes, 1 unit rest
                for (let cycle = 0; cycle < 2; cycle++) {
                    playTone(notes.B5, 3*unit, time, 0.7); time += 3*unit;
                    time += 1*unit;
                    playTone(notes.E6, 3*unit, time, 0.7); time += 3*unit;
                    time += 1*unit;
                    playTone(notes.A6, 3*unit, time, 0.7); time += 3*unit;
                    time += 1*unit;
                    playTone(notes.B6, 3*unit, time, 0.75); time += 3*unit;
                    time += 1*unit;
                }
                
                // Brief pause between repetitions (except after last)
                if (repeat < 2) {
                    time += 10*unit; // 400ms gap
                }
            }
            
            setTimeout(() => {
                document.getElementById('status').textContent = 'Complete. 3 full cycles (~16 seconds total)';
            }, 17000);
        }

        function stopAll() {
            scheduledNotes.forEach(osc => {
                try { osc.stop(); } catch(e) {}
            });
            scheduledNotes = [];
            document.getElementById('status').textContent = 'Ready. Square wave synthesis matches watch buzzer.';
        }
    </script>
</body>
</html>
